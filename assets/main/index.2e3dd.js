window.__require=function e(i,t,o){function n(s,r){if(!t[s]){if(!i[s]){var a=s.split("/");if(a=a[a.length-1],!i[a]){var u="function"==typeof __require&&__require;if(!r&&u)return u(a,!0);if(c)return c(a,!0);throw new Error("Cannot find module '"+s+"'")}s=a}var h=t[s]={exports:{}};i[s][0].call(h.exports,function(e){return n(i[s][1][e]||e)},h,h.exports,e,i,t,o)}return t[s].exports}for(var c="function"==typeof __require&&__require,s=0;s<o.length;s++)n(o[s]);return n}({FruitFactory:[function(e,i){"use strict";cc._RF.push(i,"5ba0biz2HhFDoXsCEnXEDtd","FruitFactory");var t=e("./../view/FruitView");cc.Class({extends:cc.Component,properties:{fruitPrefab:cc.Prefab},getFruit:function(){var e=this.getFruitLevel(),i=cc.instantiate(this.fruitPrefab);i.parent=this.node;var o=i.getComponent(t);return o.setLevel(e),o},getFruitLevel:function(){return Math.floor(5*Math.random())}}),cc._RF.pop()},{"./../view/FruitView":"FruitView"}],FruitView:[function(e,i){"use strict";cc._RF.push(i,"a0bceyYXeBGmo7PDff9ZEb/","FruitView"),e("FruitView"),cc.Class({extends:cc.Component,properties:{rigidbody:cc.RigidBody,collider:cc.Collider,fruitSprite:cc.Sprite,fruitScaleSizeByLevel:[cc.Float],fruitTexture:[cc.SpriteFrame],fruitDefaultSize:30,fruitScaleSize:0,level:0},start:function(){this.node.scale=0,this.rigidbody.type=cc.RigidBodyType.Static},setLevel:function(e){this.level=e,this.fruitSprite.spriteFrame=this.fruitTexture[e],this.fruitScaleSize=this.fruitScaleSizeByLevel[e],this.collider.tag=e,this.node.scale=this.fruitScaleSize},dropDown:function(e,i){this.animateFruitMoveXAxis(e,i)},onBeginContact:function(e,i,t){var o=this;if(this.level===t.tag&&!this._isBeingFusion)if(this._isBeingFusion=!0,this.node.uuid<t.node.uuid)this.node.removeFromParent(),this._isBeingFusion=!1;else if(this.node.uuid>t.node.uuid){t.node.removeFromParent();var n=this.level+1,c=new cc.Event.EventCustom("fruitcombine",!0);c.detail=n,this.node.dispatchEvent(c),this.setLevel(n),this.animateFruitFusion(function(){return o._isBeingFusion=!1})}},animateFruitMoveXAxis:function(e,i){var t=this;cc.tween(this.node).to(.35,{x:{value:e,easing:"expoOut"}}).call(function(){t.rigidbody.type=cc.RigidBodyType.Dynamic,i&&i()}).delay(1.5).call(function(){t._isCompletedDropping=!0}).start()},animateFruitSpawn:function(e){this.node.scale=0,cc.tween(this.node).to(.25,{scale:{value:this.fruitScaleSize,easing:"sineIn"}}).call(function(){return e&&e()}).start()},animateFruitFusion:function(e){this.node.scale=0,cc.tween(this.node).to(.15,{scale:{value:this.fruitScaleSize,easing:"sineIn"}}).call(function(){return e&&e()}).start()},animateExplosion:function(){this.node.removeFromParent()},animateWarning:function(){this._warningTween=cc.tween(this.node).to(.5,{color:{value:cc.Color.RED,easing:"sineIn"}}).to(.5,{color:{value:cc.Color.WHITE,easing:"sineIn"}}).to(.5,{color:{value:cc.Color.RED,easing:"sineIn"}}).to(.5,{color:{value:cc.Color.WHITE,easing:"sineIn"}}).to(.5,{color:{value:cc.Color.RED,easing:"sineIn"}}).to(.5,{color:{value:cc.Color.WHITE,easing:"sineIn"}}).to(.5,{color:{value:cc.Color.RED,easing:"sineIn"}}).to(.5,{color:{value:cc.Color.WHITE,easing:"sineIn"}}).to(.5,{color:{value:cc.Color.RED,easing:"sineIn"}}).to(.5,{color:{value:cc.Color.WHITE,easing:"sineIn"}}).to(.5,{color:{value:cc.Color.RED,easing:"sineIn"}}).to(.5,{color:{value:cc.Color.WHITE,easing:"sineIn"}}).repeatForever().start()},update:function(){if(this._isCompletedDropping)if(this.node.y+this.node.height*this.node.scale/2>507){if(this._hasWarnning)return;this._hasWarnning=!0,this.animateWarning(),this.startGameOverCountdown(),console.log("WARNING "+this.node.uuid)}else{if(!this._hasWarnning)return;this._hasWarnning=!1,this._countdown&&clearTimeout(this._countdown),this.node.color=cc.Color.WHITE,this._warningTween&&this._warningTween.stop(),console.log("STOP WARNING "+this.node.uuid)}},startGameOverCountdown:function(){var e=this;this._countdown=setTimeout(function(){console.log("FIRE EVENT "+e.node.uuid),e.node.dispatchEvent(new cc.Event.EventCustom("fruitoverlimit",!0))},3e3)}}),cc._RF.pop()},{FruitView:"FruitView"}],GameOverView:[function(e,i){"use strict";cc._RF.push(i,"8bdb57b1qhPi6G7a2iZ6SPo","GameOverView"),cc.Class({extends:cc.Component,properties:{scoreLabel:cc.Label},show:function(e){this.node.active=!0,this.scoreLabel.string="SCORE: "+e},replay:function(){cc.director.loadScene("mainGame")}}),cc._RF.pop()},{}],LineLimitView:[function(e,i){"use strict";cc._RF.push(i,"5848e+pJTFNY5UMtA1cyzYf","LineLimitView"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){this.node.width=cc.winSize.width,this.node.height=.2*cc.winSize.height,this.node.y=.8*cc.winSize.height/2},start:function(){}}),cc._RF.pop()},{}],MainGameController:[function(e,i){"use strict";cc._RF.push(i,"025812yNeBPSoW3kv06EGE0","MainGameController");var t=e("./FruitFactory"),o=e("../view/GameOverView");cc.Class({extends:cc.Component,properties:{fruitFactory:t,gameOver:o,fruitSpawnPos:cc.Vec2,scoreLabel:cc.Label,score:0},onLoad:function(){this.physicsManager=cc.director.getPhysicsManager(),this.physicsManager.enabled=!0},start:function(){this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.on("fruitcombine",this.onFruitCombine,this),this.node.on("fruitoverlimit",this.onFruitOverLimit,this),this.createFruit()},createFruit:function(){var e=this.fruitFactory.getFruit();e.node.y=.8*cc.winSize.height-200,e.node.x=cc.winSize.width/2,e.animateFruitSpawn(),this._curFruitSelector=e,this._canCreateFruit=!0},onTouchEnd:function(e){var i=this;if(this._curFruitSelector&&this._canCreateFruit){this._canCreateFruit=!1;var t=e.getLocationX();this._curFruitSelector.dropDown(t,function(){i._curFruitSelector=null,setTimeout(function(){i.createFruit()},1500)})}},onTouchMove:function(e){this._curFruitSelector&&(this._curFruitSelector.node.x=e.getLocationX())},onFruitCombine:function(e){e.stopPropagation(),this.score+=5*(e.detail-1)+10,this.scoreLabel.string=""+this.score},onFruitOverLimit:function(){this._isGameEnd||(this._isGameEnd=!0,this.showGameOver())},showGameOver:function(){this.gameOver.show(this.score)}}),cc._RF.pop()},{"../view/GameOverView":"GameOverView","./FruitFactory":"FruitFactory"}],MouseInput:[function(e,i){"use strict";cc._RF.push(i,"da8faR7nPBD/o2kWJ6TYq3I","MouseInput"),cc.Class({extends:cc.Component,properties:{target:cc.Prefab},start:function(){this.node.on(cc.Node.EventType.MOUSE_DOWN,this.onMouseMove,this)},onMouseMove:function(e){var i=e.getLocation(),t=cc.instantiate(this.target);t.parent=this.node.parent,t.x=i.x,t.y=i.y,console.log("position",i)}}),cc._RF.pop()},{}],PlatformHelper:[function(e,i){"use strict";var t;cc._RF.push(i,"6c6feM0k09B/oS+IhdmOEDS","PlatformHelper"),t=cc.Enum({Top:0,Bottom:1,Left:2,Right:3}),cc.Class({extends:cc.Component,properties:{physicsBoxCollider:cc.PhysicsBoxCollider,state:t.Top},onLoad:function(){switch(this.state){case t.Top:this.physicsBoxCollider.size.width=cc.winSize.width,this.physicsBoxCollider.size.height=.2*cc.winSize.height,this.physicsBoxCollider.offset.y=-.8*cc.winSize.height/2;case t.Bottom:this.physicsBoxCollider.size.width=cc.winSize.width,this.physicsBoxCollider.size.height=.1*cc.winSize.height,this.physicsBoxCollider.offset.y=-.9*cc.winSize.height/2;break;case t.Left:this.physicsBoxCollider.size.width=100,this.physicsBoxCollider.size.height=cc.winSize.height,this.physicsBoxCollider.offset.x=(cc.winSize.width+100)/2*-1;break;case t.Right:this.physicsBoxCollider.size.width=100,this.physicsBoxCollider.size.height=cc.winSize.height,this.physicsBoxCollider.offset.x=(cc.winSize.width+100)/2}}}),cc._RF.pop()},{}],ScreenAspectHelper:[function(e,i){"use strict";cc._RF.push(i,"bb3e4QSDZpOwovUiR8n4t9q","ScreenAspectHelper"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){this.node.height=cc.winSize.height,this.node.y=cc.winSize.height/2}}),cc._RF.pop()},{}]},{},["FruitFactory","MainGameController","MouseInput","PlatformHelper","ScreenAspectHelper","FruitView","GameOverView","LineLimitView"]);